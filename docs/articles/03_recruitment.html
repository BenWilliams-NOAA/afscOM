<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Recruitment • afscOM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Recruitment">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">afscOM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/afscOM.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/01_model_dimensions.html">Model Dimensions</a>
    </li>
    <li>
      <a href="../articles/02_specifying_demographic_parameters.html">Specifying Demographic Rates</a>
    </li>
    <li>
      <a href="../articles/03_recruitment.html">Recruitment</a>
    </li>
    <li>
      <a href="../articles/04_removals.html">Removals</a>
    </li>
    <li>
      <a href="../articles/05_model_options.html">Model Options</a>
    </li>
    <li>
      <a href="../articles/06_observation_processes.html">Observation Processes</a>
    </li>
    <li>
      <a href="../articles/07_multiyear_projections.html">Conducting Multiyear Projections</a>
    </li>
    <li>
      <a href="../articles/08_alaska_sablefish.html">A Spatial Model Example</a>
    </li>
    <li>
      <a href="../articles/09_spatial_om_example.html">A Spatial Model Example</a>
    </li>
    <li>
      <a href="../articles/10_nep_transboundary_sablefish.html">Example: Northeast Pacific Transboundary Sablefish Model</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Recruitment</h1>
            
      

      <div class="hidden name"><code>03_recruitment.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="specifying-recruitment">Specifying Recruitment<a class="anchor" aria-label="anchor" href="#specifying-recruitment"></a>
</h2>
<p>The projection functions require an annual recruitment input. This
input can be provided in several ways, depending on the exact use case
of the model.</p>
<p>The simplest way is to provide a direct timeseries of recruitment of
dimensions <code>[nyears, nregions]</code>. If done in this way, the
underlying projection module will use EXACTLY the provided recruitment
to simulate the population, with each region being allocated exactly the
specified amount of recruits. This is most useful for replicating
existing models. If a model is composed of a single region, recruitment
timeseries can alternatively be provided as a vector of length
<code>nyears</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nyears</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">nregions</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span></span>
<span><span class="va">simple_recruitment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">30</span>, dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">nyears</span>, <span class="va">nregions</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/project.html">project</a></span><span class="op">(</span><span class="va">init_naa</span>, <span class="va">removals_timeseries</span>, recruitment<span class="op">=</span><span class="va">simple_recruitment</span>, <span class="va">dem_params</span>, <span class="va">nyears</span>, <span class="va">model_options</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="recruitment-in-multiple-region-models">Recruitment in Multiple Region Models<a class="anchor" aria-label="anchor" href="#recruitment-in-multiple-region-models"></a>
</h4>
<p>If a multi-region model is being parameterized users can also specify
a 1D vector of annual recruitment (that will be taken as system wide
recruitment) and a matrix of annual recruitment apportionment (via
<code>model_options$recruit_apportionment)</code> of dimensions
<code>[nyears, nregions]</code>, which will allocate the total number of
recruits (the input vector) across regions based on the provided
apportionment scheme. The rows of the apportionment matrix should sum to
1.0, but this will not be checked internally.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nyears</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">nregions</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span></span>
<span><span class="co"># Global recruitment timeseries (recruits across all regions)</span></span>
<span><span class="va">rec_timeseries</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">30</span>, dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">nyears</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Alocate 75% of recruits to region 1 and 25% to region 2</span></span>
<span><span class="va">recruit_apportionment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">0.25</span><span class="op">)</span>, nrow<span class="op">=</span><span class="va">nyears</span>, ncol<span class="op">=</span><span class="va">nregions</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">model_options</span><span class="op">$</span><span class="va">recruit_apportionment</span> <span class="op">&lt;-</span> <span class="va">recruit_apportionment</span></span>
<span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/project.html">project</a></span><span class="op">(</span><span class="va">init_naa</span>, <span class="va">removals_timeseries</span>, recruitment<span class="op">=</span><span class="va">rec_timeseries</span>, <span class="va">dem_params</span>, <span class="va">nyears</span>, <span class="va">model_options</span><span class="op">)</span></span></code></pre></div>
<p>In multi-region models, users can also specify whether regional
recruitment apportionment should be stochastic via the
<code>model_options$recruit_apportion_random</code>. If
<code>TRUE</code>, the model will perform a multinomial sample from the
provided apportionment matrix (see description above), using a sample
size of 30, thus adding some stochasticity to annual recruitment
apportionment. This feature is most useful when performing multiple
simulations using the <code>simulate_multiple</code> projection wrapper.
Additionally, users can specify whether recruits are subject to
recruitment in the year of recruitment via
<code>model_options$do_recruits_move</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nyears</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">nregions</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span></span>
<span><span class="co"># Global recruitment timeseries (recruits across all regions)</span></span>
<span><span class="va">rec_timeseries</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">30</span>, dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">nyears</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Alocate 75% of recruits to region 1 and 25% to region 2</span></span>
<span><span class="va">recruit_apportionment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">0.25</span><span class="op">)</span>, nrow<span class="op">=</span><span class="va">nyears</span>, ncol<span class="op">=</span><span class="va">nregions</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">model_options</span><span class="op">$</span><span class="va">recruit_apportionment</span> <span class="op">&lt;-</span> <span class="va">recruit_apportionment</span></span>
<span><span class="va">model_options</span><span class="op">$</span><span class="va">recruit_apportion_random</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span> <span class="co"># Add stochsticty around 75-25 recruitment split</span></span>
<span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/project.html">project</a></span><span class="op">(</span><span class="va">init_naa</span>, <span class="va">removals_timeseries</span>, recruitment<span class="op">=</span><span class="va">rec_timeseries</span>, <span class="va">dem_params</span>, <span class="va">nyears</span>, <span class="va">model_options</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="recruitment-functions">Recruitment Functions<a class="anchor" aria-label="anchor" href="#recruitment-functions"></a>
</h4>
<p>The final way that recruitment can be specified is through a
recruitment function. Many fisheries population dynamics model assume a
stock-recruit relationship relating current stock size to future
recruitment. To specify recruitment in this way, users should define an
R function that accepts as input: 1) a
<code>[1, nages, nsexes, nregions]</code> dimensional array of
numbers-at-age; and 2) a list of demographic parameters subset to a
single year (all demographic inputs will have dimension
<code>[1, nages, nsexes, nregions, nfleets]</code>). Additional
parameters can also be supplied to a user-defined recruitment function,
but only the current simulations timestep’s numbers-at-age array and
demographic parameters are directly available to such function. All
other parameters must be specified at the start of the simulation.</p>
<p>Once defined, a reference to this function is provided to the
projection function in lieu of a direct timeseries of recruitment. The
projection function internally handles passing the annual population
state as a parameter to the function. To specify the values of
additional stock-recruit parameters (e.g., steepness or unfished
recruitment in a Beverton-holt function), users must create a named list
of said parameters and their respective values and assign it to
<code>model_options$recruitment_pars</code>. Below is an example
defining a Beverton-Holt stock recruit function, and building the
appropriate parameter options list.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nyears</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">nregions</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span></span>
<span><span class="va">recruit_function</span> <span class="op">&lt;-</span> <span class="va">beverton_holt</span></span>
<span><span class="va">model_options</span><span class="op">$</span><span class="va">recruitment_pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    h <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>    R0 <span class="op">=</span> <span class="fl">25</span>,</span>
<span>    S0 <span class="op">=</span> <span class="fl">300</span>,</span>
<span>    sigR <span class="op">=</span> <span class="fl">1.2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/project.html">project</a></span><span class="op">(</span><span class="va">init_naa</span>, <span class="va">removals_timeseries</span>, recruitment<span class="op">=</span><span class="va">recruit_function</span>, <span class="va">dem_params</span>, <span class="va">nyears</span>, <span class="va">model_options</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Benjamin Williams, Joshua Zahner, Matt Cheng, Maia Kapur.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer>
</div>






  </body>
</html>
